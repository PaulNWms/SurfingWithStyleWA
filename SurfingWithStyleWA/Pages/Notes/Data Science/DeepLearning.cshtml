@page "/notes/data-science/deep-learning"

<h1>Deep Learning</h1>

<div class="kaypro10"><pre>Links:
<a target="_blank" href="https://selfdrivingcars.mit.edu/deeptraffic/">Deep Traffic</a>
<a target="_blank" href="https://www.manning.com/books/grokking-deep-learning">Grokking Deep Learning</a>

<em>Type</em> of machine learning: supervised vs. unsupervised

<em>Method</em> of machine learning: parametric (trial-and-error) vs. non-parametric ("counting")

Deep learning is a class of parametric model.

# stare at this
weight = 0.5
goal_pred = 0.8
input = 2
alpha = 0.1
for iteration in range(20):
    pred = input * weight
    error = (pred - goal_pred) ** 2
    derivative = input * (pred - goal_pred)
    weight = weight - (alpha * derivative)
    print("Error:" + str(error) + " Prediction:" + str(pred))

Stochastic Gradient Descent updates the weights after each input.
Batch Gradient Descent updates the weights after each batch of input.

# start at this
import numpy as np
np.random.seed(1)
 
def relu(x):
    return (x > 0) * x # returns x if x > 0
                       # return 0 otherwise
 
def relu2deriv(output):
    return output>0 # returns 1 for input > 0
                    # return 0 otherwise
streetlights = np.array( [[ 1, 0, 1 ],
                          [ 0, 1, 1 ],
                          [ 0, 0, 1 ],
                          [ 1, 1, 1 ] ] )
 
walk_vs_stop = np.array([[ 1, 1, 0, 0]]).T
 
alpha = 0.2
hidden_size = 4
 
weights_0_1 = 2*np.random.random((3,hidden_size)) - 1
weights_1_2 = 2*np.random.random((hidden_size,1)) - 1
 
for iteration in range(60):
    layer_2_error = 0
    for i in range(len(streetlights)):
        layer_0 = streetlights[i:i+1]
        layer_1 = relu(np.dot(layer_0,weights_0_1))
        layer_2 = np.dot(layer_1,weights_1_2)
 
        layer_2_error += np.sum((layer_2 - walk_vs_stop[i:i+1]) ** 2)
        layer_2_delta = (layer_2 - walk_vs_stop[i:i+1])
        layer_1_delta=layer_2_delta.dot(weights_1_2.T)*relu2deriv(layer_1)
        weights_1_2 -= alpha * layer_1.T.dot(layer_2_delta)
        weights_0_1 -= alpha * layer_0.T.dot(layer_1_delta)
 
    if(iteration % 10 == 9):
        print("Error:" + str(layer_2_error))

Normalization techniques:
- minibatch
- early stopping
- dropout

Activation functions:
- relu is fast
- sigmoid is often used for output because it squishes the values between 0 and 1
- tanh is often used for middle layers because it squishes the values between -1 and 1

Output activation functions:
- predicting raw data values (like temperature) => no activation
- predicting yes/no probabilities => sigmoid
- predicting "which one" probabilities => softmax

<u>function   forward prop                     back prop delta</u>
- Relu     ones_and_zeros = (input > 0)     mask = output > 0
           output = input*ones_and_zeros    deriv = output * mask
- Sigmoid  output = 1/(1 + np.exp(-input))  deriv = output*(1-output)
- Tanh     output = np.tanh(input)          deriv = 1 - (output**2)
- Softmax  temp = np.exp(input)             temp = (output - true)
           output /= np.sum(temp)           output = temp/len(true)

A convolution layer aggregates the kernels with sum pooling, mean pooling, or max pooling.  Max pooling is the most common.

When a neural network needs to use the same idea in mutliple places, endeavor to use the same weights in both places.

The perceptron step works as follows. For a point with coordinates (p,q), label y, and prediction given by the equation ŷ = step(w₁x₁ + w₂x₂ + b):
∀ points:
    - If the point is correctly classified, do nothing.
    - If the point is classified positive, but it has a negative label, subtract αp, αq, and α from w₁, w₂ and b respectively.
    - If the point is classified negative, but it has a positive label, add αp, αq, and α from w₁, w₂ and b respectively.

By replacing the step function with the sigmoid function, ŷ = σ(w₁x₁ + w₂x₂ + b) becomes a probability that the point is above or below the line.
</pre>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-23-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>=</mo><mo>&amp;#x2211;</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><msub><mo stretchy="false">)</mo><mi>j</mi></msub><mo>=</mo><mfrac><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mi>j</mi></msub></mrow></msup><mrow><munderover><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>K</mi></mrow></munderover><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-877" style="width: 14.26em; display: inline-block;"><span style="width: 13.83em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -3.21em; position: absolute; clip: rect(1.68em, 1013.83em, 4.64em, -1000em);"><span class="mrow" id="MathJax-Span-878"><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math; font-style: italic;">S<span style="width: 0.03em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-880" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-881" style="font-family: MathJax_Math; font-style: italic;">f<span style="width: 0.06em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-883" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-884" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-886" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-887" style="padding-left: 0.27em; font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span class="mo" id="MathJax-Span-888" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-889"><span class="mrow" id="MathJax-Span-890"><span class="mi" id="MathJax-Span-891" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="msubsup" id="MathJax-Span-892"><span style="width: 0.75em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.07em, 1000.29em, 4.43em, -1000em);"><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main;">)</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.38em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-894" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-895" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mfrac" id="MathJax-Span-896" style="padding-left: 0.27em;"><span style="width: 3.86em; height: 0px; margin-right: 0.12em; margin-left: 0.12em; display: inline-block; position: relative;"><span style="left: 50%; top: -4.68em; margin-left: -0.56em; position: absolute; clip: rect(3.14em, 1001.13em, 4.19em, -1000em);"><span class="msubsup" id="MathJax-Span-897"><span style="width: 1.12em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.43em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-898" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.46em; top: -4.36em; position: absolute;"><span class="texatom" id="MathJax-Span-899"><span class="mrow" id="MathJax-Span-900"><span class="msubsup" id="MathJax-Span-901"><span style="width: 0.58em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.51em, 1000.33em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-902" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">z<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.32em; top: -3.89em; position: absolute;"><span class="mi" id="MathJax-Span-903" style="font-family: MathJax_Math; font-size: 50%; font-style: italic;">j</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 50%; top: -3.05em; margin-left: -1.87em; position: absolute; clip: rect(2.86em, 1003.74em, 4.48em, -1000em);"><span class="mrow" id="MathJax-Span-904"><span class="munderover" id="MathJax-Span-905"><span style="width: 2.4em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.07em, 1001em, 4.43em, -1000em);"><span class="mo" id="MathJax-Span-906" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.05em; top: -4.48em; position: absolute; clip: rect(3.34em, 1000.7em, 4.18em, -1000em);"><span class="texatom" id="MathJax-Span-907"><span class="mrow" id="MathJax-Span-908"><span class="mi" id="MathJax-Span-909" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">K<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.05em; top: -3.71em; position: absolute; clip: rect(3.33em, 1001.34em, 4.19em, -1000em);"><span class="texatom" id="MathJax-Span-910"><span class="mrow" id="MathJax-Span-911"><span class="mi" id="MathJax-Span-912" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">k</span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main; font-size: 70.7%;">=</span><span class="mn" id="MathJax-Span-914" style="font-family: MathJax_Main; font-size: 70.7%;">1</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="msubsup" id="MathJax-Span-915" style="padding-left: 0.16em;"><span style="width: 1.18em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.43em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-916" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.46em; top: -4.29em; position: absolute;"><span class="texatom" id="MathJax-Span-917"><span class="mrow" id="MathJax-Span-918"><span class="msubsup" id="MathJax-Span-919"><span style="width: 0.64em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.51em, 1000.33em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-920" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">z<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.32em; top: -3.89em; position: absolute;"><span class="mi" id="MathJax-Span-921" style="font-family: MathJax_Math; font-size: 50%; font-style: italic;">k</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0em; top: -1.31em; position: absolute; clip: rect(0.83em, 1003.86em, 1.27em, -1000em);"><span style="width: 3.86em; height: 0px; overflow: hidden; vertical-align: 0em; border-top-color: currentColor; border-top-width: 1.3px; border-top-style: solid; display: inline-block;"></span><span style="width: 0px; height: 1.09em; display: inline-block;"></span></span></span></span></span><span style="width: 0px; height: 3.21em; display: inline-block;"></span></span></span><span style="width: 0px; height: 2.8em; overflow: hidden; vertical-align: -1.34em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>=</mo><mo>∑</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><msub><mo stretchy="false">)</mo><mi>j</mi></msub><mo>=</mo><mfrac><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mi>j</mi></msub></mrow></msup><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>K</mi></mrow></munderover><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></math></span></span></div>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-24-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-922" style="width: 22.81em; display: inline-block;"><span style="width: 22.14em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(0.44em, 1022.05em, 3.56em, -1000em);"><span class="mrow" id="MathJax-Span-923"><span class="mi" id="MathJax-Span-924" style="font-family: MathJax_Math; font-style: italic;">C<span style="width: 0.04em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-925" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-926" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-928" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-929" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-930" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-931" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-933" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-935" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-936" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-937" style="padding-left: 0.27em; font-family: MathJax_Main;">−</span><span class="munderover" id="MathJax-Span-938" style="padding-left: 0.16em;"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(2.87em, 1001.38em, 4.63em, -1000em);"><span class="mo" id="MathJax-Span-939" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.14em; top: -2.91em; position: absolute; clip: rect(3.35em, 1001.09em, 4.29em, -1000em);"><span class="texatom" id="MathJax-Span-940"><span class="mrow" id="MathJax-Span-941"><span class="mi" id="MathJax-Span-942" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-943" style="font-family: MathJax_Main; font-size: 70.7%;">=</span><span class="mn" id="MathJax-Span-944" style="font-family: MathJax_Main; font-size: 70.7%;">1</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.41em; top: -5.15em; position: absolute; clip: rect(3.41em, 1000.6em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-945" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">m</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="msubsup" id="MathJax-Span-946" style="padding-left: 0.16em;"><span style="width: 0.8em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.49em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-948" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mi" id="MathJax-Span-949" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-950" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-951" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-952"><span style="width: 0.82em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.38em, -1000em);"><span class="mi" id="MathJax-Span-953" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.5em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-955" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-956" style="padding-left: 0.22em; font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-957" style="padding-left: 0.22em; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-958" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-959" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-960" style="padding-left: 0.22em;"><span style="width: 0.8em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-961" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.49em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-962" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-963" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-964" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-965" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-966" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-967" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-968" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-969" style="padding-left: 0.22em;"><span style="width: 0.82em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.38em, -1000em);"><span class="mi" id="MathJax-Span-970" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.5em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-971" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-972" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 2.96em; overflow: hidden; vertical-align: -1.29em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-25-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>C</mi><mi>E</mi><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-973" style="width: 16.44em; display: inline-block;"><span style="width: 15.95em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(0.44em, 1015.86em, 3.69em, -1000em);"><span class="mrow" id="MathJax-Span-974"><span class="mi" id="MathJax-Span-975" style="font-family: MathJax_Math; font-style: italic;">M<span style="width: 0.08em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-976" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-977" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-979" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-980" style="font-family: MathJax_Math; font-style: italic;">C<span style="width: 0.04em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-981" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-982" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-983" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-985" style="font-family: MathJax_Math; font-style: italic;">C<span style="width: 0.04em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-986" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-987" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-988" style="padding-left: 0.27em; font-family: MathJax_Main;">−</span><span class="munderover" id="MathJax-Span-989" style="padding-left: 0.16em;"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(2.87em, 1001.38em, 4.63em, -1000em);"><span class="mo" id="MathJax-Span-990" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.14em; top: -2.91em; position: absolute; clip: rect(3.35em, 1001.09em, 4.29em, -1000em);"><span class="texatom" id="MathJax-Span-991"><span class="mrow" id="MathJax-Span-992"><span class="mi" id="MathJax-Span-993" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-994" style="font-family: MathJax_Main; font-size: 70.7%;">=</span><span class="mn" id="MathJax-Span-995" style="font-family: MathJax_Main; font-size: 70.7%;">1</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.51em; top: -5.15em; position: absolute; clip: rect(3.41em, 1000.41em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-996" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">n</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="munderover" id="MathJax-Span-997" style="padding-left: 0.16em;"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(2.87em, 1001.38em, 4.63em, -1000em);"><span class="mo" id="MathJax-Span-998" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.12em; top: -2.91em; position: absolute; clip: rect(3.35em, 1001.14em, 4.43em, -1000em);"><span class="texatom" id="MathJax-Span-999"><span class="mrow" id="MathJax-Span-1000"><span class="mi" id="MathJax-Span-1001" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span class="mo" id="MathJax-Span-1002" style="font-family: MathJax_Main; font-size: 70.7%;">=</span><span class="mn" id="MathJax-Span-1003" style="font-family: MathJax_Main; font-size: 70.7%;">1</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.41em; top: -5.15em; position: absolute; clip: rect(3.41em, 1000.6em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-1004" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">m</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1005" style="padding-left: 0.16em;"><span style="width: 1.1em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-1006" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.49em; top: -3.85em; position: absolute;"><span class="texatom" id="MathJax-Span-1007"><span class="mrow" id="MathJax-Span-1008"><span class="mi" id="MathJax-Span-1009" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-1010" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mi" id="MathJax-Span-1011" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1012" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-1013" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1014"><span style="width: 1.11em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.38em, -1000em);"><span class="mi" id="MathJax-Span-1015" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.5em; top: -3.85em; position: absolute;"><span class="texatom" id="MathJax-Span-1016"><span class="mrow" id="MathJax-Span-1017"><span class="mi" id="MathJax-Span-1018" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-1019" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-1020" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 3.1em; overflow: hidden; vertical-align: -1.43em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>C</mi><mi>E</mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-4-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">&amp;#x005E;</mo></mover></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">&amp;#x005E;</mo></mover></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-145" style="width: 20.27em; display: inline-block;"><span style="width: 19.66em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(0.44em, 1019.56em, 3.56em, -1000em);"><span class="mrow" id="MathJax-Span-146"><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-152" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-153" style="padding-left: 0.27em; font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-154"><span style="width: 0.99em; height: 0px; margin-right: 0.12em; margin-left: 0.12em; display: inline-block; position: relative;"><span style="left: 50%; top: -4.68em; margin-left: -0.25em; position: absolute; clip: rect(3.15em, 1000.42em, 4.18em, -1000em);"><span class="mn" id="MathJax-Span-155" style="font-family: MathJax_Main;">1</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 50%; top: -3.31em; margin-left: -0.43em; position: absolute; clip: rect(3.38em, 1000.85em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0em; top: -1.31em; position: absolute; clip: rect(0.83em, 1000.99em, 1.27em, -1000em);"><span style="width: 0.99em; height: 0px; overflow: hidden; vertical-align: 0em; border-top-color: currentColor; border-top-width: 1.3px; border-top-style: solid; display: inline-block;"></span><span style="width: 0px; height: 1.09em; display: inline-block;"></span></span></span></span><span class="munderover" id="MathJax-Span-157" style="padding-left: 0.16em;"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(2.87em, 1001.38em, 4.63em, -1000em);"><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.14em; top: -2.91em; position: absolute; clip: rect(3.35em, 1001.09em, 4.29em, -1000em);"><span class="texatom" id="MathJax-Span-159"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main; font-size: 70.7%;">=</span><span class="mn" id="MathJax-Span-163" style="font-family: MathJax_Main; font-size: 70.7%;">1</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.41em; top: -5.15em; position: absolute; clip: rect(3.41em, 1000.6em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">m</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-166" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-167" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-168" style="padding-left: 0.22em;"><span style="width: 0.8em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.49em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-175" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-176" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-177" style="padding-left: 0.22em;"><span style="width: 0.9em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.06em, 1000.49em, 4.39em, -1000em);"><span class="texatom" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="munderover" id="MathJax-Span-180"><span style="width: 0.58em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.08em; top: -4.06em; position: absolute; clip: rect(3.12em, 1000.38em, 3.65em, -1000em);"><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">^</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.58em; top: -3.76em; position: absolute;"><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-185" style="padding-left: 0.22em; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-186" style="padding-left: 0.22em;"><span style="width: 0.8em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.49em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-192"><span style="width: 0.9em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.06em, 1000.49em, 4.39em, -1000em);"><span class="texatom" id="MathJax-Span-193"><span class="mrow" id="MathJax-Span-194"><span class="munderover" id="MathJax-Span-195"><span style="width: 0.58em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.08em; top: -4.06em; position: absolute; clip: rect(3.12em, 1000.38em, 3.65em, -1000em);"><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main;">^</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.58em; top: -3.76em; position: absolute;"><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-199" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 2.96em; overflow: hidden; vertical-align: -1.29em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-5-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">(</mo><mi>W</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03C3;</mi><mo stretchy="false">(</mo><mi>W</mi><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>&amp;#x03C3;</mi><mo stretchy="false">(</mo><mi>W</mi><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-200" style="width: 30.58em; display: inline-block;"><span style="width: 29.67em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(0.44em, 1029.57em, 3.56em, -1000em);"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-206" style="padding-left: 0.16em; font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-208" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-209" style="padding-left: 0.27em; font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-210"><span style="width: 0.99em; height: 0px; margin-right: 0.12em; margin-left: 0.12em; display: inline-block; position: relative;"><span style="left: 50%; top: -4.68em; margin-left: -0.25em; position: absolute; clip: rect(3.15em, 1000.42em, 4.18em, -1000em);"><span class="mn" id="MathJax-Span-211" style="font-family: MathJax_Main;">1</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 50%; top: -3.31em; margin-left: -0.43em; position: absolute; clip: rect(3.38em, 1000.85em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0em; top: -1.31em; position: absolute; clip: rect(0.83em, 1000.99em, 1.27em, -1000em);"><span style="width: 0.99em; height: 0px; overflow: hidden; vertical-align: 0em; border-top-color: currentColor; border-top-width: 1.3px; border-top-style: solid; display: inline-block;"></span><span style="width: 0px; height: 1.09em; display: inline-block;"></span></span></span></span><span class="munderover" id="MathJax-Span-213" style="padding-left: 0.16em;"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(2.87em, 1001.38em, 4.63em, -1000em);"><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.14em; top: -2.91em; position: absolute; clip: rect(3.35em, 1001.09em, 4.29em, -1000em);"><span class="texatom" id="MathJax-Span-215"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main; font-size: 70.7%;">=</span><span class="mn" id="MathJax-Span-219" style="font-family: MathJax_Main; font-size: 70.7%;">1</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.41em; top: -5.15em; position: absolute; clip: rect(3.41em, 1000.6em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">m</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-222" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-223" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-224" style="padding-left: 0.22em;"><span style="width: 0.8em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.49em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-231" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-232" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-233" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">σ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="msubsup" id="MathJax-Span-236"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.52em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.57em; top: -4.41em; position: absolute;"><span class="texatom" id="MathJax-Span-238"><span class="mrow" id="MathJax-Span-239"><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-243" style="padding-left: 0.22em; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-244" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-247" style="padding-left: 0.22em; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-248" style="padding-left: 0.22em;"><span style="width: 0.8em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.49em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math; font-style: italic;">σ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="msubsup" id="MathJax-Span-257"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.52em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.57em; top: -4.41em; position: absolute;"><span class="texatom" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-264" style="padding-left: 0.22em; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-265" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 2.96em; overflow: hidden; vertical-align: -1.29em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">(</mo><mi>W</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>W</mi><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>W</mi><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-6-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">&amp;#x005E;</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" style="width: 17.72em; display: inline-block;"><span style="width: 17.17em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(0.44em, 1017.07em, 3.69em, -1000em);"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math; font-style: italic;">M<span style="width: 0.08em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Math; font-style: italic;">C<span style="width: 0.04em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-285" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-286" style="padding-left: 0.27em; font-family: MathJax_Main;">−</span><span class="munderover" id="MathJax-Span-287" style="padding-left: 0.16em;"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(2.87em, 1001.38em, 4.63em, -1000em);"><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.14em; top: -2.91em; position: absolute; clip: rect(3.35em, 1001.09em, 4.29em, -1000em);"><span class="texatom" id="MathJax-Span-289"><span class="mrow" id="MathJax-Span-290"><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main; font-size: 70.7%;">=</span><span class="mn" id="MathJax-Span-293" style="font-family: MathJax_Main; font-size: 70.7%;">1</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.51em; top: -5.15em; position: absolute; clip: rect(3.41em, 1000.41em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">n</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="munderover" id="MathJax-Span-295" style="padding-left: 0.16em;"><span style="width: 1.44em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(2.87em, 1001.38em, 4.63em, -1000em);"><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.12em; top: -2.91em; position: absolute; clip: rect(3.35em, 1001.14em, 4.43em, -1000em);"><span class="texatom" id="MathJax-Span-297"><span class="mrow" id="MathJax-Span-298"><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main; font-size: 70.7%;">=</span><span class="mn" id="MathJax-Span-301" style="font-family: MathJax_Main; font-size: 70.7%;">1</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.41em; top: -5.15em; position: absolute; clip: rect(3.41em, 1000.6em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">m</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="msubsup" id="MathJax-Span-303" style="padding-left: 0.16em;"><span style="width: 1.1em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.49em; top: -3.85em; position: absolute;"><span class="texatom" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-312"><span style="width: 1.19em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.06em, 1000.49em, 4.39em, -1000em);"><span class="texatom" id="MathJax-Span-313"><span class="mrow" id="MathJax-Span-314"><span class="munderover" id="MathJax-Span-315"><span style="width: 0.58em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.08em; top: -4.06em; position: absolute; clip: rect(3.12em, 1000.38em, 3.65em, -1000em);"><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main;">^</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.58em; top: -3.76em; position: absolute;"><span class="texatom" id="MathJax-Span-318"><span class="mrow" id="MathJax-Span-319"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 3.1em; overflow: hidden; vertical-align: -1.43em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div>
<pre>The derivative of the sigmoid function is really simple (here the tick means first-order derivative):</pre>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-1-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>&amp;#x03C3;</mi><mo>&amp;#x2032;</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03C3;</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 10.19em; display: inline-block;"><span style="width: 9.89em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(1.19em, 1009.79em, 2.61em, -1000em);"><span class="mrow" id="MathJax-Span-2"><span class="msup" id="MathJax-Span-3"><span style="width: 0.89em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.39em, 1000.57em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">σ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.62em; top: -4.41em; position: absolute;"><span class="mo" id="MathJax-Span-5" style="font-family: MathJax_Main; font-size: 70.7%;">′</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-9" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-10" style="padding-left: 0.27em; font-family: MathJax_Math; font-style: italic;">σ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-15" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-16" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-17" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">σ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 1.21em; overflow: hidden; vertical-align: -0.32em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>σ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div>
<pre>After applying some calculus, this is the gradient step (here the tick means new value):</pre>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-1-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>w</mi><mi>i</mi><mo>&amp;#x2032;</mo></msubsup><mo stretchy="false">&amp;#x2190;</mo><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy="false">(</mo><mi>y</mi><mo>&amp;#x2212;</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">&amp;#x005E;</mo></mover></mrow><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="2em" /><msup><mi>b</mi><mo>&amp;#x2032;</mo></msup><mo stretchy="false">&amp;#x2190;</mo><mi>b</mi><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy="false">(</mo><mi>y</mi><mo>&amp;#x2212;</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">&amp;#x005E;</mo></mover></mrow><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 19.6em; display: inline-block;"><span style="width: 18.99em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(1.19em, 1018.89em, 2.67em, -1000em);"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="width: 1.03em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.69em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.71em; top: -4.31em; position: absolute; clip: rect(3.42em, 1000.27em, 4.15em, -1000em);"><span class="mo" id="MathJax-Span-5" style="font-family: MathJax_Main; font-size: 70.7%;">′</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.71em; top: -3.7em; position: absolute; clip: rect(3.35em, 1000.32em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-7" style="padding-left: 0.27em; font-family: MathJax_Main;">←</span><span class="msubsup" id="MathJax-Span-8" style="padding-left: 0.27em;"><span style="width: 1.03em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.69em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.71em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-11" style="padding-left: 0.22em; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-12" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">α</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-15" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="texatom" id="MathJax-Span-16" style="padding-left: 0.22em;"><span class="mrow" id="MathJax-Span-17"><span class="munderover" id="MathJax-Span-18"><span style="width: 0.58em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.08em; top: -4.06em; position: absolute; clip: rect(3.12em, 1000.38em, 3.65em, -1000em);"><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">^</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-22"><span style="width: 0.89em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.52em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.57em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mspace" id="MathJax-Span-25" style="width: 2em; height: 0em; overflow: hidden; vertical-align: 0em; display: inline-block;"></span><span class="msup" id="MathJax-Span-26"><span style="width: 0.69em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.12em, 1000.42em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.42em; top: -4.41em; position: absolute;"><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main; font-size: 70.7%;">′</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-29" style="padding-left: 0.27em; font-family: MathJax_Main;">←</span><span class="mi" id="MathJax-Span-30" style="padding-left: 0.27em; font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-31" style="padding-left: 0.22em; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-32" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">α</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-35" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="texatom" id="MathJax-Span-36" style="padding-left: 0.22em;"><span class="mrow" id="MathJax-Span-37"><span class="munderover" id="MathJax-Span-38"><span style="width: 0.58em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.08em; top: -4.06em; position: absolute; clip: rect(3.12em, 1000.38em, 3.65em, -1000em);"><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">^</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 1.27em; overflow: hidden; vertical-align: -0.38em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>w</mi><mi>i</mi><mo>′</mo></msubsup><mo stretchy="false">←</mo><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="2em"></mspace><msup><mi>b</mi><mo>′</mo></msup><mo stretchy="false">←</mo><mi>b</mi><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span></div>
<pre>Feedforward:</pre>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-1-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">&amp;#x005E;</mo></mover></mrow><mo>=</mo><mi>&amp;#x03C3;</mi><mo>&amp;#x2218;</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>&amp;#x2218;</mo><mo>&amp;#x2026;</mo><mo>&amp;#x2218;</mo><mi>&amp;#x03C3;</mi><mo>&amp;#x2218;</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>&amp;#x2218;</mo><mi>&amp;#x03C3;</mi><mo>&amp;#x2218;</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 18.69em; display: inline-block;"><span style="width: 18.14em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(1.05em, 1018.04em, 2.61em, -1000em);"><span class="mrow" id="MathJax-Span-2"><span class="texatom" id="MathJax-Span-3"><span class="mrow" id="MathJax-Span-4"><span class="munderover" id="MathJax-Span-5"><span style="width: 0.58em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.49em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">y<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.08em; top: -4.06em; position: absolute; clip: rect(3.12em, 1000.38em, 3.65em, -1000em);"><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">^</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-8" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-9" style="padding-left: 0.27em; font-family: MathJax_Math; font-style: italic;">σ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-10" style="padding-left: 0.22em; font-family: MathJax_Main;">∘</span><span class="msubsup" id="MathJax-Span-11" style="padding-left: 0.22em;"><span style="width: 2.17em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.12em; top: -4.41em; position: absolute;"><span class="texatom" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">n</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-18" style="padding-left: 0.22em; font-family: MathJax_Main;">∘</span><span class="mo" id="MathJax-Span-19" style="padding-left: 0.22em; font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-20" style="padding-left: 0.22em; font-family: MathJax_Main;">∘</span><span class="mi" id="MathJax-Span-21" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">σ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-22" style="padding-left: 0.22em; font-family: MathJax_Main;">∘</span><span class="msubsup" id="MathJax-Span-23" style="padding-left: 0.22em;"><span style="width: 2.1em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.12em; top: -4.41em; position: absolute;"><span class="texatom" id="MathJax-Span-25"><span class="mrow" id="MathJax-Span-26"><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main; font-size: 70.7%;">2</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-30" style="padding-left: 0.22em; font-family: MathJax_Main;">∘</span><span class="mi" id="MathJax-Span-31" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">σ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-32" style="padding-left: 0.22em; font-family: MathJax_Main;">∘</span><span class="msubsup" id="MathJax-Span-33" style="padding-left: 0.22em;"><span style="width: 2.1em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.12em; top: -4.41em; position: absolute;"><span class="texatom" id="MathJax-Span-35"><span class="mrow" id="MathJax-Span-36"><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mn" id="MathJax-Span-38" style="font-family: MathJax_Main; font-size: 70.7%;">1</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 1.35em; overflow: hidden; vertical-align: -0.32em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><mi>σ</mi><mo>∘</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>∘</mo><mo>…</mo><mo>∘</mo><mi>σ</mi><mo>∘</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>∘</mo><mi>σ</mi><mo>∘</mo><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><pre>The error gradient is a long vector with an entry for each weight:</pre>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-2-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">&amp;#x2207;</mi><mi>E</mi><mo>=</mo><mo stretchy="false">(</mo><mo>&amp;#x2026;</mo><mo>,</mo><mfrac><mrow><mi>&amp;#x03B4;</mi><mi>E</mi></mrow><mrow><mi>&amp;#x03B4;</mi><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>,</mo><mo>&amp;#x2026;</mo><mo stretchy="false">)</mo></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" style="width: 10.31em; display: inline-block;"><span style="width: 10.01em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(0.6em, 1009.91em, 3.85em, -1000em);"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Main;">∇</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-45" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-46" style="padding-left: 0.27em; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-48" style="padding-left: 0.16em; font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-49" style="padding-left: 0.16em;"><span style="width: 2.69em; height: 0px; margin-right: 0.12em; margin-left: 0.12em; display: inline-block; position: relative;"><span style="left: 50%; top: -4.68em; margin-left: -0.6em; position: absolute; clip: rect(3.1em, 1001.21em, 4.19em, -1000em);"><span class="mrow" id="MathJax-Span-50"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math; font-style: italic;">δ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 50%; top: -2.96em; margin-left: -1.28em; position: absolute; clip: rect(2.77em, 1002.57em, 4.63em, -1000em);"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math; font-style: italic;">δ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="msubsup" id="MathJax-Span-55"><span style="width: 2.12em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.12em; top: -4.52em; position: absolute; clip: rect(3.29em, 1000.99em, 4.36em, -1000em);"><span class="texatom" id="MathJax-Span-57"><span class="mrow" id="MathJax-Span-58"><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">k</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.94em; top: -3.7em; position: absolute; clip: rect(3.35em, 1000.61em, 4.33em, -1000em);"><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0em; top: -1.31em; position: absolute; clip: rect(0.83em, 1002.69em, 1.27em, -1000em);"><span style="width: 2.69em; height: 0px; overflow: hidden; vertical-align: 0em; border-top-color: currentColor; border-top-width: 1.3px; border-top-style: solid; display: inline-block;"></span><span style="width: 0px; height: 1.09em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-67" style="padding-left: 0.16em; font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">)</span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 3.09em; overflow: hidden; vertical-align: -1.59em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∇</mi><mi>E</mi><mo>=</mo><mo stretchy="false">(</mo><mo>…</mo><mo>,</mo><mfrac><mrow><mi>δ</mi><mi>E</mi></mrow><mrow><mi>δ</mi><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>,</mo><mo>…</mo><mo stretchy="false">)</mo></math></span></span></div>
<pre>Backpropagation:</pre>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-3-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">&amp;#x2200;</mi><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mtext>&amp;#xA0;in&amp;#xA0;</mtext><mi mathvariant="normal">&amp;#x2207;</mi><mi>E</mi><mo>:</mo><mspace width="1em" /><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi></mi><mo>&amp;#x2032;</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">&amp;#x2190;</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>&amp;#x2212;</mo><mi>&amp;#x03B1;</mi><mfrac><mrow><mi>&amp;#x03B4;</mi><mi>E</mi></mrow><mrow><mi>&amp;#x03B4;</mi><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-69" style="width: 18.69em; display: inline-block;"><span style="width: 18.14em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(0.6em, 1018.14em, 3.85em, -1000em);"><span class="mrow" id="MathJax-Span-70"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Main;">∀</span><span class="msubsup" id="MathJax-Span-72"><span style="width: 2.12em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.12em; top: -4.52em; position: absolute; clip: rect(3.29em, 1000.99em, 4.36em, -1000em);"><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">k</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.94em; top: -3.7em; position: absolute; clip: rect(3.35em, 1000.61em, 4.33em, -1000em);"><span class="texatom" id="MathJax-Span-79"><span class="mrow" id="MathJax-Span-80"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mtext" id="MathJax-Span-83" style="font-family: MathJax_Main;">&nbsp;in&nbsp;</span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Main;">∇</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mo" id="MathJax-Span-86" style="padding-left: 0.27em; font-family: MathJax_Main;">:</span><span class="mspace" id="MathJax-Span-87" style="width: 1em; height: 0em; overflow: hidden; vertical-align: 0em; display: inline-block;"></span><span class="msubsup" id="MathJax-Span-88" style="padding-left: 0.27em;"><span style="width: 2.31em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.12em; top: -4.52em; position: absolute; clip: rect(3.28em, 1001.18em, 4.36em, -1000em);"><span class="texatom" id="MathJax-Span-90"><span class="mrow" id="MathJax-Span-91"><span class="msup" id="MathJax-Span-92"><span style="width: 0.19em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.82em, 1000em, 4.18em, -1000em);"><span class="mi" id="MathJax-Span-93" style="font-size: 70.7%;"></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0em; top: -4.26em; position: absolute;"><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; font-size: 50%;">′</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">k</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.94em; top: -3.7em; position: absolute; clip: rect(3.35em, 1000.61em, 4.33em, -1000em);"><span class="texatom" id="MathJax-Span-98"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-102" style="padding-left: 0.27em; font-family: MathJax_Main;">←</span><span class="msubsup" id="MathJax-Span-103" style="padding-left: 0.27em;"><span style="width: 2.12em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.12em; top: -4.52em; position: absolute; clip: rect(3.29em, 1000.99em, 4.36em, -1000em);"><span class="texatom" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">k</span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.94em; top: -3.7em; position: absolute; clip: rect(3.35em, 1000.61em, 4.33em, -1000em);"><span class="texatom" id="MathJax-Span-110"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-114" style="padding-left: 0.22em; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-115" style="padding-left: 0.22em; font-family: MathJax_Math; font-style: italic;">α</span><span class="mfrac" id="MathJax-Span-116"><span style="width: 2.69em; height: 0px; margin-right: 0.12em; margin-left: 0.12em; display: inline-block; position: relative;"><span style="left: 50%; top: -4.68em; margin-left: -0.6em; position: absolute; clip: rect(3.1em, 1001.21em, 4.19em, -1000em);"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math; font-style: italic;">δ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic;">E<span style="width: 0.02em; height: 1px; overflow: hidden; display: inline-block;"></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 50%; top: -2.96em; margin-left: -1.28em; position: absolute; clip: rect(2.77em, 1002.57em, 4.63em, -1000em);"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">δ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="msubsup" id="MathJax-Span-122"><span style="width: 2.12em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 1.12em; top: -4.52em; position: absolute; clip: rect(3.29em, 1000.99em, 4.36em, -1000em);"><span class="texatom" id="MathJax-Span-124"><span class="mrow" id="MathJax-Span-125"><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main; font-size: 70.7%;">(</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">k</span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main; font-size: 70.7%;">)</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.94em; top: -3.7em; position: absolute; clip: rect(3.35em, 1000.61em, 4.33em, -1000em);"><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0em; top: -1.31em; position: absolute; clip: rect(0.83em, 1002.69em, 1.27em, -1000em);"><span style="width: 2.69em; height: 0px; overflow: hidden; vertical-align: 0em; border-top-color: currentColor; border-top-width: 1.3px; border-top-style: solid; display: inline-block;"></span><span style="width: 0px; height: 1.09em; display: inline-block;"></span></span></span></span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 3.09em; overflow: hidden; vertical-align: -1.59em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∀</mi><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mtext>&nbsp;in&nbsp;</mtext><mi mathvariant="normal">∇</mi><mi>E</mi><mo>:</mo><mspace width="1em"></mspace><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi></mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">←</mo><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>−</mo><mi>α</mi><mfrac><mrow><mi>δ</mi><mi>E</mi></mrow><mrow><mi>δ</mi><msubsup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac></math></span></span></div>
<pre>
If you can't find the right size of pants, it's better to go for the slightly larger pair and use a belt.

# Putting together a <a target="_blank" href="https://keras.io/getting-started/sequential-model-guide/">Keras</a> network is straightforward:
model = Sequential()
model.add(...) # a bunch of layers here
model.compile(loss='binary_crossentropy', optimizer='rmsprop', metrics=['accuracy'])
model.fit(x_train, y_train, epochs=20, batch_size=128)
score = model.evaluate(x_test, y_test, batch_size=128)

An epoch is a single forward and backward pass of the whole dataset.

Backpropagation (another notation):
</pre>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-1-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>&amp;#x03B4;</mi><mi>j</mi><mi>h</mi></msubsup><mo>=</mo><mo>&amp;#x2211;</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mi>k</mi></mrow></msub><msubsup><mi>&amp;#x03B4;</mi><mi>k</mi><mn>0</mn></msubsup><msup><mi>f</mi><mo>&amp;#x2032;</mo></msup><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 9.4em; display: inline-block;"><span style="width: 9.1em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -3.21em; position: absolute; clip: rect(2.08em, 1009em, 3.84em, -1000em);"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="width: 0.98em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.1em, 1000.45em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">δ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.5em; top: -4.35em; position: absolute; clip: rect(3.33em, 1000.48em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">h</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.44em; top: -3.7em; position: absolute; clip: rect(3.35em, 1000.36em, 4.33em, -1000em);"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-7" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-8" style="padding-left: 0.27em; font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span class="texatom" id="MathJax-Span-9" style="padding-left: 0.16em;"><span class="mrow" id="MathJax-Span-10"><span class="msubsup" id="MathJax-Span-11"><span style="width: 1.67em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.14em, 1001.04em, 4.2em, -1000em);"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">W<span style="width: 0.1em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.94em; top: -3.85em; position: absolute;"><span class="texatom" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">k</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="msubsup" id="MathJax-Span-17"><span style="width: 0.93em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.1em, 1000.45em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math; font-style: italic;">δ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.5em; top: -4.36em; position: absolute; clip: rect(3.35em, 1000.43em, 4.2em, -1000em);"><span class="mn" id="MathJax-Span-19" style="font-family: MathJax_Main; font-size: 70.7%;">0</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.44em; top: -3.67em; position: absolute; clip: rect(3.33em, 1000.44em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">k</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="msup" id="MathJax-Span-21"><span style="width: 0.88em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.11em, 1000.55em, 4.39em, -1000em);"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math; font-style: italic;">f<span style="width: 0.06em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.61em; top: -4.41em; position: absolute;"><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main; font-size: 70.7%;">′</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-25"><span style="width: 0.94em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.12em, 1000.55em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.57em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main;">)</span></span></span></span><span style="width: 0px; height: 3.21em; display: inline-block;"></span></span></span><span style="width: 0px; height: 1.56em; overflow: hidden; vertical-align: -0.52em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>δ</mi><mi>j</mi><mi>h</mi></msubsup><mo>=</mo><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mi>k</mi></mrow></msub><msubsup><mi>δ</mi><mi>k</mi><mn>0</mn></msubsup><msup><mi>f</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></math></span></span></div>
<div class="MathJax_Display" style="text-align: center;"><span tabindex="0" class="MathJax" id="MathJax-Element-2-Frame" role="presentation" style="text-align: center; position: relative;" data-mathml='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">&amp;#x0394;</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>&amp;#x03B7;</mi><msubsup><mi>&amp;#x03B4;</mi><mi>j</mi><mi>h</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub></math>'><nobr aria-hidden="true"><span class="math" id="MathJax-Span-29" style="width: 6.01em; display: inline-block;"><span style="width: 5.82em; height: 0px; font-size: 103%; display: inline-block; position: relative;"><span style="left: 0em; top: -2.18em; position: absolute; clip: rect(1.15em, 1005.82em, 2.81em, -1000em);"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-32"><span style="width: 1.32em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.69em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.71em; top: -3.85em; position: absolute;"><span class="texatom" id="MathJax-Span-34"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="mo" id="MathJax-Span-38" style="padding-left: 0.27em; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-39" style="padding-left: 0.27em; font-family: MathJax_Math; font-style: italic;">η<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span class="msubsup" id="MathJax-Span-40"><span style="width: 0.98em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.1em, 1000.45em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math; font-style: italic;">δ<span style="width: 0em; height: 1px; overflow: hidden; display: inline-block;"></span></span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.5em; top: -4.35em; position: absolute; clip: rect(3.33em, 1000.48em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">h</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.44em; top: -3.7em; position: absolute; clip: rect(3.35em, 1000.36em, 4.33em, -1000em);"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span><span class="msubsup" id="MathJax-Span-44"><span style="width: 0.89em; height: 0px; display: inline-block; position: relative;"><span style="left: 0em; top: -4em; position: absolute; clip: rect(3.38em, 1000.52em, 4.19em, -1000em);"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span><span style="left: 0.57em; top: -3.85em; position: absolute;"><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="width: 0px; height: 4em; display: inline-block;"></span></span></span></span></span><span style="width: 0px; height: 2.18em; display: inline-block;"></span></span></span><span style="width: 0px; height: 1.45em; overflow: hidden; vertical-align: -0.52em; border-left-color: currentColor; border-left-width: 0px; border-left-style: solid; display: inline-block;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>η</mi><msubsup><mi>δ</mi><mi>j</mi><mi>h</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub></math></span></span></div>
</div>